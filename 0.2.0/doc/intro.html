<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link rel="stylesheet" href="theme/face/face.css">
<meta name="keywords" content="">
<meta name="description" content="指引">
<title>指引</title>
</head>
<body>
<div class="face-one-head">
    <a class="face-one-head-logo" href="../index.html">
        <img src="theme/media/logo.svg" alt="" class="face-one-head-logo-photo" />
        react-spread-props
    </a>
    <span class="face-one-head-slogan">
        Write less code, do more things!
    </span>
    <!-- <div class="face-one-head-search">
        <span class="face-one-head-search-icon fi fi-search"></span>
        <input type="text" class="face-one-head-search-input" placeholder="搜索..." />
    </div> -->
    <div class="face-one-head-nav">
        <span class="face-one-head-nav-switch fi fi-bars"></span>
        <div class="face-one-head-nav-F-cnt">
            <a href="../index.html" class="face-one-head-nav-link">首页</a>
            <a href="intro.html" class="face-one-head-nav-link">指引</a>
            <a href="index.html" class="face-one-head-nav-link">文档</a>
        </div>
        <script>
        Array.from(document.querySelectorAll('.face-one-head-nav-link')).forEach(function (node) {
            if (node.href) {
                var pathname = node.href.replace(/\?.*/, '')
                if (pathname === location.origin + location.pathname) {
                    node.setAttribute('class', node.getAttribute('class') + ' ' + 'face-one-head-nav-link--on')
                }
            }
        })
        </script>
    </div>
</div>

<div class="face-one-layout">
<div class="face-one-layout-F-line">
<div class="face-one-layout-sidebar">
<div class="face-one-nav">
<span class="face-one-nav-switch fi fi-menu-unfold"></span>
<div class="face-one-nav-F-inner">
<div class="face-one-nav-item">
    <a href="intro.html" class="face-one-nav-item-label">指引</a>
</div>
<div class="face-one-nav-item">
    <a href="index.html" class="face-one-nav-item-label">文档</a>
</div>
<!-- face-one-nav-item--group-on 控制默认展开 -->
<!-- <div class="face-one-nav-item face-one-nav-item--group face-one-nav-item--group-on">
    <span class="face-one-nav-item-switch fi fi-down"></span>
    <span class="face-one-nav-item-label">
        文档
    </span>
    <div class="face-one-nav-item-group">
        <div class="face-one-nav-item-group-title">示例</div>
        <a href="index.html#style" class="face-one-nav-item-group-item">颜色</a>
        <a href="index.html#border" class="face-one-nav-item-group-item">边框</a>
    </div>
    <div class="face-one-nav-item-group">
        <div class="face-one-nav-item-group-title">自定义界面</div>
        <a href="index.html#less" class="face-one-nav-item-group-item">less</a>
    </div>
</div> -->

</div>
</div>
</div>
<div class="face-one-layout-cnt">
<div id="face-one-cnt" class="face-one-cnt markdown-body">
<div id="face-one-sidebar" class="face-one-sidebar"></div>
<h1 id="指引" ><a class="markrun-anchor" href="../Users/rain2/Documents/onface/react-spread-props/#指引"><span class="markrun-anchor-link"></span></a>指引</h1><blockquote>
<p>使用一个组件或模块之前，应当知道它能解决的问题是什么，不能解决的问题是什么。使用的最佳实践是什么？</p>
</blockquote>
<p><code>react-spread-props</code> 专门解决日常开发中传递 <code>props</code> 的同时代理绑定事件的需求。</p>
<p>例如开发一个检测用户点击后递增计数的组件：</p>

    <div class="face-one-code  face-one-code--open ">
                        <div class="face-one-code-F-view">
                            <div class="face-one-code-example">
                                
                            </div>
                            <div class="face-one-code-info">
                                <div class="face-one-code-info-title">计数按钮</div>
                                <div class="face-one-code-info-desc">
                                    
                                </div>
                                <span class="face-one-code-info-switchCode fi fi-code"></span>
                            </div>
                        </div>
                        <div class="face-one-code-source">
                            <div class="face-one-code-source-tool">
                                <span class="face-one-code-source-tool-copy fi fi-files-o"></span>
                            </div>
                            <pre><code class="lang-js">import React , { Component } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>
class GeneralButton extends Component {
    constructor (props) {
        super(props)
        const <span class="hljs-literal">self</span> = this
        <span class="hljs-literal">self</span>.<span class="hljs-keyword">state</span> = {
            count: <span class="hljs-number">0</span>
        }
    }
    render() {
        const <span class="hljs-literal">self</span> = this
        return (
            <span class="hljs-variable">&lt;button
                {...self.props}
                onClick={(e) =&gt;</span> {
                    if (<span class="hljs-literal">self</span>.props.<span class="hljs-keyword">on</span>Click) {
                        <span class="hljs-literal">self</span>.props.<span class="hljs-keyword">on</span>Click(e)
                    }
                    <span class="hljs-literal">self</span>.<span class="hljs-built_in">set</span>State({
                        count: <span class="hljs-literal">self</span>.<span class="hljs-keyword">state</span>.count + <span class="hljs-number">1</span>
                    }, function () {
                        if (<span class="hljs-literal">self</span>.<span class="hljs-keyword">state</span>.count &gt; <span class="hljs-number">3</span>) {
                            if (<span class="hljs-literal">self</span>.props.<span class="hljs-keyword">on</span>GreaterThree) {
                                <span class="hljs-literal">self</span>.props.<span class="hljs-keyword">on</span>GreaterThree()
                            }
                        }
                    })
                }}
            &gt;{<span class="hljs-literal">self</span>.<span class="hljs-keyword">state</span>.count}&lt;/button&gt;
        )
    }
}
export <span class="hljs-keyword">default</span> GeneralButton

</code></pre>
                        </div>
                        
                    </div>
                                
<p>使用计数按钮</p>

    <div class="face-one-code  face-one-code--open ">
                        <div class="face-one-code-F-view">
                            <div class="face-one-code-example">
                                <div id="intro-genneral-button-node"></div>
                            </div>
                            <div class="face-one-code-info">
                                <div class="face-one-code-info-title">调用计数按钮</div>
                                <div class="face-one-code-info-desc">
                                    
                                </div>
                                <span class="face-one-code-info-switchCode fi fi-code"></span>
                            </div>
                        </div>
                        <div class="face-one-code-source">
                            <div class="face-one-code-source-tool">
                                <span class="face-one-code-source-tool-copy fi fi-files-o"></span>
                            </div>
                            <pre><code class="lang-js">import ReactDOM <span class="hljs-keyword">from</span> <span class="hljs-string">"react-dom"</span>
import GeneralButton <span class="hljs-keyword">from</span> <span class="hljs-string">"./GeneralButton.js"</span>
ReactDOM.render(
    (
        <span class="hljs-variable">&lt;div&gt;</span>
            <span class="hljs-variable">&lt;GeneralButton style={{border: '1px solid red'}} /&gt;</span>
            传递样式
            <span class="hljs-variable">&lt;hr/&gt;</span>

            <span class="hljs-variable">&lt;GeneralButton onClick={(e) =&gt;</span> {
                console.<span class="hljs-keyword">log</span>('既可以触发递增，也可以触发用户绑定的 <span class="hljs-keyword">on</span>Click')
            }} /&gt;
            绑定 <span class="hljs-keyword">on</span>Click
            <span class="hljs-variable">&lt;hr/&gt;</span>
            <span class="hljs-variable">&lt;GeneralButton onGreaterThree={() =&gt;</span> {
                console.<span class="hljs-keyword">log</span>('大于<span class="hljs-number">3</span>')
            }} /&gt;
            大于<span class="hljs-number">3</span>时回调
        &lt;/div&gt;
    ),
    document.getElementById('intro-genneral-button-node')
)

</code></pre>
                        </div>
                        
                            
                            
                    </div>
                                
<p>观察控制台会看见报错</p>
<pre><code class="lang-shell">Warning: Unknown event handler <span class="hljs-keyword">property</span><span class="hljs-title"> </span>`onGreaterThree`. It will be ignored.
</code></pre>
<p>因为传递 <code>props</code> 的同时代理用户绑定事件的实现代码是：</p>
<pre><code class="lang-js">{...<span class="hljs-literal">self</span>.props}
<span class="hljs-keyword">on</span>Click={(e) =&gt; {
    if (<span class="hljs-literal">self</span>.props.<span class="hljs-keyword">on</span>Click) {
        <span class="hljs-literal">self</span>.props.<span class="hljs-keyword">on</span>Click(e)
    }
    <span class="hljs-literal">self</span>.<span class="hljs-built_in">set</span>State({
        count: <span class="hljs-literal">self</span>.<span class="hljs-keyword">state</span>.count + <span class="hljs-number">1</span>
    }, function () {
        if (<span class="hljs-literal">self</span>.<span class="hljs-keyword">state</span>.count &gt; <span class="hljs-number">3</span>) {
            if (<span class="hljs-literal">self</span>.props.<span class="hljs-keyword">on</span>GreaterThree) {
                <span class="hljs-literal">self</span>.props.<span class="hljs-keyword">on</span>GreaterThree()
            }
        }
    })
}}
</code></pre>
<p>因为 <code>{...self.props}</code> 传递了 <code>onGreaterThree</code> 所以会报错。想要不传递 <code>onGreaterThree</code> 就要过滤 <code>onGreaterThree</code></p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> spreadProps = <span class="hljs-built_in">Object</span>.assign({}, self.props.props)
<span class="hljs-keyword">var</span> ignoreProps = [<span class="hljs-string">'onGreaterThree'</span>]
<span class="hljs-built_in">Object</span>.keys(spreadProps).filter(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">key</span>) </span>{
    <span class="hljs-keyword">return</span> ignoreProps.includes(key)
})
<span class="hljs-comment">// 然后传递 spreadProps</span>
{...spreadProps}
</code></pre>
<p>至此实现了传递 <code>props</code> 的同时代理绑定事件的需求。</p>
<p>因为开发组件过程中需要做 react spread props 的操作太多了，所以将实现过程封装成函数能提高开发效率。</p>

    <div class="face-one-code  face-one-code--open ">
                        <div class="face-one-code-F-view">
                            <div class="face-one-code-example">
                                
                            </div>
                            <div class="face-one-code-info">
                                <div class="face-one-code-info-title">使用 react-spread-props 的按钮</div>
                                <div class="face-one-code-info-desc">
                                    
                                </div>
                                <span class="face-one-code-info-switchCode fi fi-code"></span>
                            </div>
                        </div>
                        <div class="face-one-code-source">
                            <div class="face-one-code-source-tool">
                                <span class="face-one-code-source-tool-copy fi fi-files-o"></span>
                            </div>
                            <pre><code class="lang-js">import React , { Component } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>
import spreadProps <span class="hljs-keyword">from</span> <span class="hljs-string">"react-spread-props"</span>
class Button extends Component {
    constructor (props) {
        super(props)
        const <span class="hljs-literal">self</span> = this
        <span class="hljs-literal">self</span>.<span class="hljs-keyword">state</span> = {
            count: <span class="hljs-number">0</span>
        }
    }
    handleClickButton = (e) =&gt; {
        <span class="hljs-literal">self</span>.<span class="hljs-built_in">set</span>State({
            count: <span class="hljs-literal">self</span>.<span class="hljs-keyword">state</span>.count + <span class="hljs-number">1</span>
        }, function () {
            if (<span class="hljs-literal">self</span>.<span class="hljs-keyword">state</span>.count &gt; <span class="hljs-number">3</span>) {
                if (<span class="hljs-literal">self</span>.props.<span class="hljs-keyword">on</span>GreaterThree) {
                    <span class="hljs-literal">self</span>.props.<span class="hljs-keyword">on</span>GreaterThree()
                }
            }
        })
    }
    render() {
        const <span class="hljs-literal">self</span> = this
        let domProps = spreadProps(
            <span class="hljs-literal">self</span>.props,
            { <span class="hljs-keyword">on</span>Click: handleClickButton }
        )
        return (
            <span class="hljs-variable">&lt;button {...domProps} &gt;</span>{<span class="hljs-literal">self</span>.<span class="hljs-keyword">state</span>.count}&lt;/button&gt;
        )
    }
}
export <span class="hljs-keyword">default</span> Button

</code></pre>
                        </div>
                        
                    </div>
                                
<p>语法: <code>spreadProps(props, proxyProps)</code></p>
<p>实现功能与 <code>&lt;GeneralButton /&gt;</code> 但代码更少更易读。(因为 <code>onGreaterThree</code> 不属于 DOM 事件，所以会被自动过滤)</p>
<h2 id="style&amp;className" ><a class="markrun-anchor" href="../Users/rain2/Documents/onface/react-spread-props/#style&amp;className"><span class="markrun-anchor-link"></span></a>style&amp;className</h2><p><code>props.style</code> 和 <code>props.className</code> 将与 <code>proxyProps.style</code> 和 <code>proxyProps.className</code> 自动合并。</p>
<p><a href="../Users/rain2/Documents/onface/react-spread-props/index.html#style&amp;className">示例代码</a></p>
<h2 id="stopTrigger" ><a class="markrun-anchor" href="../Users/rain2/Documents/onface/react-spread-props/#stopTrigger"><span class="markrun-anchor-link"></span></a>stopTrigger</h2><p>你还可以在 <code>proxyProps.onClick</code> 中控制 <code>props.onClick</code> 触发条件。</p>
<pre><code class="lang-js"><span class="hljs-keyword">let</span> domProps = spreadProps(
    self.props,
    {
        <span class="hljs-attr">onClick</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)</span>{
            <span class="hljs-comment">// do somethings</span>
            <span class="hljs-keyword">this</span>.stopTrigger()
        }
    }
)
</code></pre>
<pre><code class="lang-js">&lt;Button onClick={<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'因为 this.stopTrigger 用户绑定的 onClick 将不会被触发'</span>)
}} /&gt;
</code></pre>
<p><a href="../Users/rain2/Documents/onface/react-spread-props/index.html#stopTrigger">示例代码</a></p>
<h2 id="新的属性" ><a class="markrun-anchor" href="../Users/rain2/Documents/onface/react-spread-props/#新的属性"><span class="markrun-anchor-link"></span></a>新的属性</h2><p>万一 <code>react-spread-props</code> 错误的将一些新的 DOM 属性过滤了请及时<a href="https://github.com/onface/react-spread-props/issues/new">通知我们</a></p>
<p>你也可以先通过单独传递的方式解决这种意外情况。</p>
<pre><code class="lang-js"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span>
    </span></span><span class="hljs-template-variable">{...domProps}</span><span class="xml"><span class="hljs-tag">
    <span class="hljs-attr">futureAttr</span>=<span class="hljs-string">"Future unpredictable dom attributes"</span>
&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
</code></pre></div>
</div>
</div>
</div>
<script>
Array.from(document.querySelectorAll('.face-one-nav-item-label')).forEach(function (node) {
    if (node.href) {
        var pathname = node.href.replace(/\?.*/, '')
        if (pathname === location.origin + location.pathname + location.hash) {
            node.setAttribute('class', node.getAttribute('class') + ' ' + 'face-one-nav-item-label--on')
        }
    }
})
var faceOneGetParent = function faceOneGetParent (el, className) {
   if (el.parentNode.nodeName.toLowerCase() === 'html') {
       return null
   }
   var parentClassName = el.parentNode.getAttribute('class')
   var classNames = ''
   if (parentClassName) {
       classNames = parentClassName.split(' ')
   }
   if (classNames.indexOf(className) !== -1) {
       return el.parentNode
   }
   else {
       return faceOneGetParent(el.parentNode, className)
   }
}
Array.from(document.querySelectorAll('.face-one-nav-item-group-item')).forEach(function (node) {
    addAvativeClass(node)
    function addAvativeClass (node)  {
        if (node.href) {
            var pathname = node.href.replace(/\?.*/, '')
            if (pathname === location.origin + location.pathname + location.hash) {
                node.setAttribute('class', node.getAttribute('class') + ' ' + 'face-one-nav-item-group-item--on')
                var parentNode = faceOneGetParent(node, 'face-one-nav-item--group')
                if (parentNode) {
                    parentNode.setAttribute('class', parentNode.getAttribute('class') + ' ' + 'face-one-nav-item--group-on')
                }
            }
        }
    }

})
</script>
<div class="face-one-foot">
    <div class="face-one-foot-F-inner">
        <div class="face-one-foot-group">
            <div class="face-one-foot-group-title">
                <span class="face-one-foot-group-title-icon fi fi-github"></span>
                Github
            </div>
            <div class="face-one-foot-group-item">
                <a href="https://github.com/onface/react-spread-props" class="face-one-foot-group-item-link">react-spread-props</a>
                - 项目源码
            </div>
        </div>
        <div class="face-one-foot-group">
            <div class="face-one-foot-group-title">
                <span class="face-one-foot-group-title-icon fi fi-link"></span>
                相关站点
            </div>
            <div class="face-one-foot-group-item">
                <a href="https://onface.github.io/component-spec">component-spec</a>
                - 组件规范
            </div>
            <div class="face-one-foot-group-item">
                <a href="https://github.com/onface/module" class="face-one-foot-group-item-link">module</a>
                - 开源项目脚手架
            </div>
            <div class="face-one-foot-group-item">
                <a href="https://onface.live/" class="face-one-foot-group-item-link">onface.live</a>
                - 资源集合
            </div>
        </div>
        <div class="face-one-foot-group">
            <div class="face-one-foot-group-title">
                <span class="face-one-foot-group-title-icon fi fi-team"></span>
                社区
            </div>
            <div class="face-one-foot-group-item">
                <a href="https://github.com/onface/react-spread-props/issues" class="face-one-foot-group-item-link">Github issues</a>
            </div>
            <div class="face-one-foot-group-item">
                <a href="https://github.com/onface/react-spread-props/issues/new" class="face-one-foot-group-item-link">提交bug</a>
            </div>
        </div>
        <div class="face-one-foot-copyright">
            <a href="../index.html" class="face-one-foot-copyright-title">
                <img src="theme/media/logo.svg" class="face-one-foot-copyright-title-logo" />
            </a>
        </div>
    </div>
</div>

<script src="theme/jquery.js"></script>
<script>delete window.$</script>
<script src="theme/face/face.js" ></script>
<script data-markrun-lastrun="true">
                            document.write('<scri' + 'pt src="./Intro.GeneralButton.demo.js?v=0.2.0"' + '" ></sc' + 'ript>')
                            </script></body>
</html>